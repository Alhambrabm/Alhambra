<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
<title>Sandwicher√≠a La Alhambra</title>
<meta property="og:title" content="La Alhambra">
<meta property="og:description" content="Lomos, Milanesas y Hamburguesas">
<meta property="og:image" content="https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/Banner.webp">
<meta property="og:type" content="website">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<script>tailwind.config={theme:{extend:{colors:{'brand-black':'#0a0a0a','brand-orange':'#f97316','brand-gold':'#fbbf24','card-dark':'#171717'},fontFamily:{'header':['"Oswald"','sans-serif'],'body':['"Montserrat"','sans-serif']},boxShadow:{'neon':'0 0 10px rgba(249, 115, 22, 0.5)'}}}}</script>
<style>
    body { background-color: #050505; background-image: radial-gradient(#1a1a1a 1px, transparent 1px); background-size: 30px 30px; color: #e5e5e5; }
    body.no-scroll { overflow: hidden !important; }
    .section-header-container { display: flex; align-items: center; justify-content: center; margin-bottom: 2rem; position: relative; }
    .section-line { height: 1px; flex-grow: 1; background: linear-gradient(90deg, transparent, #f97316, transparent); opacity: 0.5; }
    .section-badge { background-color: #0a0a0a; border: 2px solid #f97316; color: #fff; padding: 0.5rem 2rem; border-radius: 9999px; font-family: 'Oswald', sans-serif; font-size: 1.5rem; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 0 15px rgba(249, 115, 22, 0.2); z-index: 10; display: flex; align-items: center; gap: 0.5rem; transition: transform 0.3s ease; }
    .menu-card { background-color: #171717; border: 1px solid #333; border-radius: 0.75rem; padding: 1rem; transition: all 0.3s ease; cursor: pointer; margin-bottom: 0.75rem; display: flex; justify-content: space-between; align-items: center; }
    .menu-card:hover { border-color: #f97316; background-color: #202020; transform: translateX(5px); }
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); display: none; justify-content: center; align-items: center; z-index: 50; backdrop-filter: blur(4px); padding: 1rem; }
    .modal-content { background: #171717; border: 1px solid #f97316; border-radius: 1rem; width: 100%; max-width: 550px; overflow: hidden; box-shadow: 0 0 30px rgba(0,0,0,0.8); animation: fadeIn 0.3s ease; display:flex; flex-direction:column; }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    .no-stock-card { opacity: 0.6; filter: grayscale(1); pointer-events:none; position:relative; }
    .no-stock-card::after { content: "SIN STOCK"; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-10deg); border: 2px solid #dc2626; color: #dc2626; font-weight: bold; font-size: 1.5rem; padding: 5px 10px; border-radius: 8px; z-index: 20; background: rgba(0,0,0,0.8); }
    .text-glow { text-shadow: 0 0 10px rgba(251, 191, 36, 0.3); }
    
    .lightbox { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 100; display: none; justify-content: center; align-items: center; animation: fadeIn 0.2s ease; }
    .lightbox img { max-width: 100%; max-height: 100%; object-fit: contain; }
    .fritas-banner { background: linear-gradient(90deg, #f97316, #fbbf24, #f97316); background-size: 200% 200%; color: black; text-align: center; font-family: 'Oswald', sans-serif; font-weight: bold; padding: 8px; text-transform: uppercase; animation: shimmer 2s infinite linear; box-shadow: 0 0 15px rgba(251, 191, 36, 0.5); border-bottom: 2px solid #000; }
    @keyframes shimmer { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
    .promo-card { border: 2px solid #fbbf24; background: linear-gradient(135deg, #451a03, #171717); position: relative; }
    .promo-badge { position: absolute; top: -10px; left: 10px; background: #fbbf24; color: black; font-weight: bold; font-size: 0.7rem; padding: 2px 8px; border-radius: 4px; font-family: 'Oswald'; box-shadow: 0 0 10px rgba(251, 191, 36, 0.5); }
    
    /* CART FLOATING BUTTON */
    .cart-float { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(10,10,10,0.9); border: 1px solid #f97316; color: white; padding: 10px 25px; border-radius: 50px; font-weight: bold; z-index: 40; display: none; align-items: center; gap: 10px; font-family: 'Oswald'; cursor: pointer; animation: popIn 0.3s; backdrop-filter: blur(5px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); font-size: 0.9rem; }
    @keyframes popIn { from{transform:translate(-50%) scale(0);} to{transform:translate(-50%) scale(1);} }
    .cart-badge { background: #f97316; color: white; border-radius: 50%; width: 22px; height: 22px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: bold; }
    
    /* CART MODAL COMPACTO */
    .cart-modal-body { padding: 15px; max-height: 60vh; overflow-y: auto; }
    .cart-item { border-bottom: 1px solid #222; padding: 10px 0; }
    .btn-remove { color: #ef4444; font-weight: bold; cursor: pointer; padding: 0 5px; font-size: 1.2rem; }
    .btn-checkout { background: #25D366; color: white; width: 100%; padding: 15px; border-radius: 10px; font-weight: bold; text-transform: uppercase; margin-top: 15px; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3); }
    
    /* NOTA SUTIL EN CARRITO */
    .cart-note-input { background: transparent; border: none; border-bottom: 1px solid #333; color: #888; width: 100%; padding: 4px 0; font-size: 0.8rem; outline: none; margin-top: 2px; }
    .cart-note-input:focus { border-color: #f97316; color: white; }
    .cart-note-input::placeholder { font-style: italic; color: #444; }

    /* CONTROLES CANTIDAD */
    .qty-control { display: flex; align-items: center; gap: 15px; margin-top: 15px; background: #222; padding: 5px; border-radius: 10px; width: fit-content; }
    .qty-btn { width: 35px; height: 35px; background: #333; color: white; border-radius: 8px; font-weight: bold; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; }
    .qty-btn:active { background: #f97316; }
</style>
</head>
<body class="font-body antialiased pb-20">
    <script type="application/json" id="db-data">{"config":{"name":"La Alhambra","subtitle":"Lomos, Milanesas y Hamburguesas","whatsapp":"1166631401","banner":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/Banner.webp","footer":"¬© 2025 Sandwicher√≠a La Alhambra","message":"¬°Gracias por elegirnos! ","location":"https://raw.githubusercontent.com/ElNoNo26/El-NoNo-page/refs/heads/main/Logo.png","phone":"1166631401","showFritas":true},"promos":[{"title":"Lomo + Fernet ","desc":"Un lomito completo + Una bomba de Fernet ","price":"$15.000","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/main/Productos/promo_1770325124797.webp","active":true}],"categories":["Lomitos","Milanesas","Hamburguesas","Papas Fritas","Bebidas"],"products":[{"id":101,"name":"Lomito Simple","price":"$8.000","category":"Lomitos","desc":"Bife de lomo, tomate, lechuga y mayonesa casera.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/main/Productos/prod_1770331553988.webp","noStock":false},{"id":102,"name":"Lomito Completo","price":"$8.500","category":"Lomitos","desc":"Jam√≥n, queso, huevo frito y vegetales.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":201,"name":"Mila Simple","price":"$7.000","category":"Milanesas","desc":"Ternera, lechuga, tomate.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":202,"name":"Mila Completa","price":"$7.500","category":"Milanesas","desc":"Con huevo, jam√≥n y queso.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":301,"name":"Hamburguesa Com√∫n","price":"$5.000","category":"Hamburguesas","desc":"Carne, lechuga, tomate.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":302,"name":"Hamburguesa Completa","price":"$5.500","category":"Hamburguesas","desc":"Con Jam√≥n, queso y huevo.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":401,"name":"Porci√≥n de Papas","price":"$4.000","category":"Papas Fritas","desc":"Para compartir.","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":501,"name":"Gaseosa Chica","price":"$3.000","category":"Bebidas","desc":"L√≠nea Coca-Cola 375cc","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":502,"name":"Gaseosa 1.5Lt","price":"$5.000","category":"Bebidas","desc":"L√≠nea Coca-Cola","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":503,"name":"Cerveza Lata","price":"$5.000","category":"Bebidas","desc":"Rubia 473cc","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/refs/heads/main/images.jpeg","noStock":false},{"id":504,"name":"Vaso Fernet","price":"$7.500","category":"Bebidas","desc":"Preparado","img":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/main/Productos/prod_1770324820462.webp","noStock":false}],"uploadedImages":[{"url":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/main/Productos/prod_1770331553988.webp","date":"5/2/2026, 7:45:55 p.m."},{"url":"https://raw.githubusercontent.com/Alhambrabm/Alhambra/main/Productos/promo_1770325124797.webp","date":"5/2/2026, 5:58:46 p.m."}]}</script>
    <div id="main-content"></div>
    
    <!-- PRODUCT DETAIL MODAL -->
    <div id="modal-overlay" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content relative">
            <button onclick="closeModal(null, true)" class="absolute top-4 right-4 bg-black/60 text-white rounded-full w-10 h-10 flex items-center justify-center z-20 hover:bg-brand-orange text-xl">√ó</button>
            <div class="h-80 w-full bg-gray-900 relative">
                <img id="modal-img" src="" class="w-full h-full object-cover cursor-zoom-in" alt="Detalle" onclick="openLightbox()">
                <div class="absolute inset-0 bg-gradient-to-t from-[#171717] to-transparent pointer-events-none"></div>
            </div>
            <div class="p-6 pt-4">
                <h3 id="modal-title" class="text-3xl font-header font-bold text-white mb-2 uppercase tracking-wide"></h3>
                <p id="modal-desc" class="text-gray-300 text-sm mb-4 leading-relaxed"></p>
                
                <div class="flex justify-between items-center border-t border-gray-800 pt-4">
                    <div class="qty-control">
                        <button class="qty-btn" onclick="changeQty(-1)">-</button>
                        <span id="modal-qty" class="text-xl font-bold w-8 text-center">1</span>
                        <button class="qty-btn" onclick="changeQty(1)">+</button>
                    </div>
                    <span id="modal-price" class="text-3xl font-header font-bold text-brand-orange text-glow"></span>
                </div>
                <button onclick="checkDrinkAndAdd()" class="w-full bg-brand-orange hover:bg-orange-500 text-white font-bold py-4 rounded-xl mt-6 text-lg shadow-neon transition uppercase">AGREGAR AL PEDIDO</button>
            </div>
        </div>
    </div>

    <!-- NOTE ASK MODAL (Intermediate Step) -->
    <div id="note-overlay" class="modal-overlay" onclick="if(event.target.id==='note-overlay') document.getElementById('note-overlay').style.display='none'">
        <div class="modal-content relative" style="max-width: 350px;">
             <!-- CLOSE BUTTON ADDED -->
            <button onclick="document.getElementById('note-overlay').style.display='none'" class="absolute top-2 right-2 text-gray-400 hover:text-white text-2xl font-bold p-2">√ó</button>
            
            <div class="p-6 text-center">
                <h3 class="text-xl font-header font-bold text-brand-orange mb-4">¬øALGUNA PREFERENCIA?</h3>
                <p class="text-gray-400 text-sm mb-4">Escribe aqu√≠ si quieres quitar alg√∫n ingrediente, punto de cocci√≥n, etc.</p>
                <input type="text" id="temp-note" class="w-full bg-[#222] border border-gray-700 text-white rounded-lg p-3 focus:border-brand-orange outline-none transition mb-6" placeholder="Ej: Sin huevo, con mayonesa...">
                <button onclick="confirmAddToCart()" class="w-full bg-white text-black font-bold py-3 rounded-xl uppercase">CONFIRMAR</button>
            </div>
        </div>
    </div>
    
    <!-- CART MODAL -->
    <div id="cart-overlay" class="modal-overlay" onclick="if(event.target.id==='cart-overlay') closeCart()">
        <div class="modal-content" style="max-width: 400px;">
            <div class="p-4 bg-[#111] border-b border-gray-800 flex justify-between items-center"><h3 class="text-xl font-bold text-white">TU PEDIDO</h3><button onclick="closeCart()" class="text-gray-400 text-2xl">√ó</button></div>
            <div id="cart-items" class="cart-modal-body"></div>
            <div class="p-4 bg-[#111] border-t border-gray-800">
                <div class="flex justify-between text-xl font-bold text-white mb-4"><span>TOTAL:</span><span id="cart-total">$0</span></div>
                <button onclick="sendOrder()" class="btn-checkout"><span>Enviar Pedido WhatsApp</span></button>
            </div>
        </div>
    </div>

    <!-- FLOATING CART BTN -->
    <div id="fab-cart" class="cart-float" onclick="openCart()">
        <span class="cart-badge" id="cart-count">0</span>
        <span>VER PEDIDO</span>
    </div>

    <div id="lightbox" class="lightbox" onclick="closeLightbox()"><img id="lightbox-img" src=""></div>
    
    <script>
        const db = JSON.parse(document.getElementById('db-data').textContent);
        const container = document.getElementById('main-content');
        let cart = [];
        let currentProduct = {};
        let currentQty = 1;

        // RENDER SITE
        let html = `<section class="relative w-full h-72 sm:h-96 bg-black overflow-hidden flex items-end justify-center pb-8"><div class="absolute inset-0 z-0"><img src="${db.config.banner}" class="w-full h-full object-cover opacity-80"><div class="absolute inset-0 bg-gradient-to-t from-[#050505] via-transparent to-transparent"></div></div><div class="relative z-10 text-center px-4"><h1 class="text-4xl sm:text-6xl font-header font-bold text-white drop-shadow-lg mb-2 text-glow uppercase">${db.config.name}</h1><p class="text-brand-orange text-lg sm:text-xl font-medium tracking-wide uppercase bg-black/50 px-4 py-1 rounded-full inline-block backdrop-blur-sm">${db.config.subtitle}</p></div></section>`;
        
        if(db.config.showFritas) html += `<div class="fritas-banner">¬°TODO SALE CON FRITAS! üçü</div>`;
        html += `<section id="menu" class="py-12 max-w-2xl mx-auto px-4">`;
        
        if(db.promos && db.promos.length > 0) {
            const activePromos = db.promos.filter(p => p.active);
            if(activePromos.length > 0) {
                html += `<div class="mb-12"><div class="section-header-container"><div class="section-line"></div><div class="section-badge" style="border-color:#fbbf24; color:#fbbf24;"><span>üî• PROMOCIONES</span></div><div class="section-line"></div></div>`;
                activePromos.forEach(p => {
                    html += `<div class="menu-card promo-card" onclick="openModal('${p.title}', '${p.price}', '${p.desc}', '${p.img || ''}', 'Promos')"><div class="promo-badge">OFERTA</div><div class="flex-1 pr-4"><h3 class="text-lg font-bold text-white mb-1">${p.title}</h3><p class="text-xs text-gray-300">${p.desc}</p></div><div class="text-xl font-header font-bold text-brand-gold">${p.price}</div></div>`;
                });
                html += `</div>`;
            }
        }
        db.categories.forEach(cat => {
            const products = db.products.filter(p => p.category === cat);
            if(products.length > 0) {
                html += `<div class="mb-12"><div class="section-header-container"><div class="section-line"></div><div class="section-badge"><span>${cat}</span></div><div class="section-line"></div></div>`;
                products.forEach(p => {
                    const img = p.img || '';
                    const stockClass = p.noStock ? 'no-stock-card' : '';
                    html += `<div class="menu-card ${stockClass}" onclick="openModal('${p.name.replace(/'/g, "\\'")}', '${p.price}', '${p.desc.replace(/'/g, "\\'")}', '${img}', '${cat}')"><div class="flex-1 pr-4"><h3 class="text-lg font-bold text-white mb-1">${p.name}</h3><p class="text-xs text-gray-400">${p.desc}</p></div><div class="text-xl font-header font-bold text-brand-gold">${p.price}</div></div>`;
                });
                html += `</div>`;
            }
        });
        html += `</section>`;
        
        let waLink = db.config.whatsapp.replace(/\D/g, '');
        if(!waLink.startsWith('549')) waLink = '549' + waLink;
        
        // FOOTER COMPLETO
        html += `<section id="contacto" class="bg-[#111] border-t border-gray-800 py-12 px-4 text-center">
            <h2 class="text-3xl font-header font-bold text-brand-orange mb-4">HAZ TU PEDIDO</h2>
            ${db.config.message ? `<p class="text-gray-300 text-base mb-8 max-w-lg mx-auto italic">"${db.config.message}"</p>` : ''}
            
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <a href="https://wa.me/${waLink}" target="_blank" class="bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transition flex items-center justify-center gap-2">WhatsApp</a>
                ${db.config.phone ? `<a href="tel:${db.config.phone}" class="bg-white hover:bg-gray-200 text-black font-bold py-3 px-8 rounded-full shadow-lg transition flex items-center justify-center gap-2">Llamar</a>` : ''}
                ${db.config.location ? `<a href="${db.config.location}" target="_blank" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transition flex items-center justify-center gap-2">Ubicaci√≥n</a>` : ''}
            </div>
            
            <p class="text-gray-500 text-xs">${db.config.footer}</p>
        </section>`;
        
        container.innerHTML = html;

        // MODAL LOGIC
        function openModal(title, price, desc, img, category) { 
            currentProduct = { title, price, category };
            currentQty = 1; // RESET QTY
            document.getElementById('modal-qty').innerText = "1";
            document.getElementById('modal-title').innerText = title; 
            updateModalTotal(); // SET INITIAL PRICE
            document.getElementById('modal-desc').innerText = desc; 
            const imgElem = document.getElementById('modal-img'); 
            if (img) { imgElem.src = img; imgElem.style.display = 'block'; } else { imgElem.style.display = 'none'; } 
            document.getElementById('modal-overlay').style.display = 'flex'; 
            document.body.classList.add('no-scroll'); 
        }

        // CANTIDAD Y PRECIO TOTAL EN MODAL
        function changeQty(diff) {
            currentQty += diff;
            if(currentQty < 1) currentQty = 1;
            document.getElementById('modal-qty').innerText = currentQty;
            updateModalTotal();
        }

        function updateModalTotal() {
            let unitPrice = parseInt(currentProduct.price.replace(/[^0-9]/g, ''));
            let total = unitPrice * currentQty;
            document.getElementById('modal-price').innerText = '$' + total.toLocaleString('es-AR');
        }

        function closeModal(event, force) { if (force || event.target.id === 'modal-overlay') { document.getElementById('modal-overlay').style.display = 'none'; document.body.classList.remove('no-scroll'); } }
        function openLightbox() { const src = document.getElementById('modal-img').src; if(!src) return; document.getElementById('lightbox-img').src = src; document.getElementById('lightbox').style.display = 'flex'; }
        function closeLightbox() { document.getElementById('lightbox').style.display = 'none'; }

        // --- DRINK CHECKER & NOTE LOGIC ---
        function checkDrinkAndAdd() {
            const cat = currentProduct.category.toLowerCase();
            // Palabras clave para saltar modal de nota
            if (cat.includes('bebida') || cat.includes('gaseosa') || cat.includes('trago') || cat.includes('cerveza') || cat.includes('agua')) {
                confirmAddToCart(true); // Es bebida, skip nota
            } else {
                askForNote(); // Es comida, preguntar nota
            }
        }

        function askForNote() {
            document.getElementById('modal-overlay').style.display = 'none'; 
            document.getElementById('temp-note').value = ''; 
            document.getElementById('note-overlay').style.display = 'flex'; 
            document.getElementById('temp-note').focus();
        }

        function confirmAddToCart(skipNote = false) {
            const note = skipNote ? '' : document.getElementById('temp-note').value.trim();
            cart.push({ ...currentProduct, note, qty: currentQty });
            
            document.getElementById('note-overlay').style.display = 'none'; 
            document.getElementById('modal-overlay').style.display = 'none'; 
            document.body.classList.remove('no-scroll');
            updateCartUI();
        }

        // CART LOGIC
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
            renderCartModal();
        }

        function updateCartNote(index, newNote) {
            cart[index].note = newNote;
        }

        function updateCartUI() {
            const fab = document.getElementById('fab-cart');
            if(cart.length > 0) {
                fab.style.display = 'flex';
                document.getElementById('cart-count').innerText = cart.length;
            } else {
                fab.style.display = 'none';
                document.getElementById('cart-overlay').style.display = 'none';
            }
        }

        function openCart() {
            renderCartModal();
            document.getElementById('cart-overlay').style.display = 'flex';
            document.body.classList.add('no-scroll'); // LOCK SCROLL
        }
        
        function closeCart() {
            document.getElementById('cart-overlay').style.display = 'none';
            document.body.classList.remove('no-scroll'); // UNLOCK SCROLL
        }

        function renderCartModal() {
            const list = document.getElementById('cart-items');
            list.innerHTML = '';
            let total = 0;
            cart.forEach((item, index) => {
                let unitPrice = parseInt(item.price.replace(/[^0-9]/g, ''));
                let itemTotal = unitPrice * item.qty;
                total += itemTotal;
                
                // COMPACT DESIGN
                list.innerHTML += `
                    <div class="cart-item">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-2">
                                <span class="bg-[#333] text-white px-2 py-1 rounded text-xs font-bold">${item.qty}x</span>
                                <div class="font-bold text-white text-sm">${item.title}</div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="text-brand-orange font-bold text-sm">$${itemTotal.toLocaleString('es-AR')}</div>
                                <div class="btn-remove" onclick="removeFromCart(${index})">√ó</div>
                            </div>
                        </div>
                        <input type="text" 
                               class="cart-note-input" 
                               placeholder="Editar nota..." 
                               value="${item.note || ''}" 
                               onkeyup="updateCartNote(${index}, this.value)">
                    </div>`;
            });
            document.getElementById('cart-total').innerText = '$' + total.toLocaleString('es-AR');
        }

        function sendOrder() {
            if(cart.length === 0) return;
            let msg = `Hola *${db.config.name}*, quiero pedir:%0A%0A`;
            let total = 0;
            cart.forEach(item => {
                let unitPrice = parseInt(item.price.replace(/[^0-9]/g, ''));
                let itemTotal = unitPrice * item.qty;
                
                msg += `‚ñ™Ô∏è *${item.qty}x* ${item.title}`;
                if(item.note) msg += ` (Nota: ${item.note})`;
                msg += ` - $${itemTotal.toLocaleString('es-AR')}%0A`;
                
                total += itemTotal;
            });
            msg += `%0A*TOTAL: $${total.toLocaleString('es-AR')}*`;
            
            let waLink = db.config.whatsapp.replace(/\D/g, '');
            if(!waLink.startsWith('549')) waLink = '549' + waLink;
            
            window.open(`https://wa.me/${waLink}?text=${msg}`, '_blank');
        }
    </script>
</body>
</html>
    